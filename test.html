<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚ã¡ã‚ƒã„ã„ãƒ„ãƒ¼ãƒ« | ç©ºå®¤ï¼†å¹³å‡ä¾¡æ ¼ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼ˆãƒ†ã‚¹ãƒˆï¼‰</title>
  <link rel="icon" type="image/png" href="mechalogo.png">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- ç¥æ—¥åˆ¤å®šãƒ­ãƒ¼ã‚«ãƒ«JSã‚’å¿…ãšå…ˆã«èª­ã¿è¾¼ã¿ -->
  <script src="japanese-holidays.js"></script>

  <!-- testå°‚ç”¨CSSï¼ˆæ—¢å­˜style.cssã¯å¤‰æ›´ã—ãªã„ï¼‰ -->
  <style>
    /* ãƒˆã‚°ãƒ«ã®è¦‹ãŸç›® */
    .compare-toggle{
      display:inline-flex; align-items:center; gap:8px;
      font-size:13px; border:1px solid #b9b9c9; border-radius:16px;
      padding:6px 10px; background:#fff; cursor:pointer; user-select:none;
      box-shadow: 0 1px 3px rgba(0,0,0,.06);
    }
    .compare-toggle[aria-pressed="true"]{ background:#f7f7fb; }
    .compare-toggle .dot{ width:10px; height:10px; border-radius:999px; background:#bbb; }
    .compare-toggle[aria-pressed="true"] .dot{ background:#2d9cdb; }

    /* å³ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼å†…ã®â€œå³ä¸Šâ€ã«å›ºå®šã€‚å¹…ã‚’æŠ¼ã—åºƒã’ãªã„ */
    .calendar-container{ position: relative; overflow: visible !important; }
    .compare-toggle-fixed{
      position:absolute; top:6px; right:8px; z-index: 2000;
      pointer-events:auto;
    }
    @media (max-width:768px){
      .compare-toggle-fixed{ right:4px; }
    }
  </style>
</head>
<body>
  <header class="app-header">
    <img src="ãƒãƒŠãƒ¼ç”»åƒ3.png" class="app-banner" alt="ãƒãƒŠãƒ¼">
  </header>

  <!-- ğŸš€éœ€è¦æ€¥é¨°æ—¥å±¥æ­´ãƒãƒŠãƒ¼ -->
  <div id="spike-banner"></div>

  <!-- æœˆé€ã‚Šãƒœã‚¿ãƒ³ -->
  <div class="nav-button-container">
    <button id="prevMonthBtn" class="custom-button"><span class="icon">â¬…ï¸</span> å‰æœˆ</button>
    <button id="currentMonthBtn" class="custom-button"><span class="icon">ğŸ“…</span> å½“æœˆ</button>
    <button id="nextMonthBtn" class="custom-button"><span class="icon">â¡ï¸</span> æ¬¡æœˆ</button>
  </div>

  <main class="calendar-main">
    <div class="graph-side" id="graph-container"></div>

    <!-- å³ï¼šã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ -->
    <div class="calendar-container" id="calendar-container">
      <!-- åˆå›ã¯ã“ã“ã«ç›´æ¥ç½®ãï¼ˆå¾Œã§å†æç”»ã•ã‚Œã¦ã‚‚JSã§å†æŒ¿å…¥ï¼‰ -->
      <div id="compareToggleHolder" class="compare-toggle-fixed">
        <button id="compareToggle" class="compare-toggle" aria-pressed="false" aria-label="è‡ªç¤¾æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡æ›¿">
          <span class="dot" aria-hidden="true"></span>
          <span>è‡ªç¤¾æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰</span>
          <span id="toggleState">OFF</span>
        </button>
      </div>
    </div>
  </main>

  <footer class="app-footer">
    <div id="last-update"></div>
    <div class="footer-note">
      <strong>ã€Šæ³¨é‡ˆã€‹</strong><br>
      ãƒ»åœ¨åº«æ•°ã€å¹³å‡ä¾¡æ ¼ã¯ã€Œãªã‚“ã°ãƒ»å¿ƒæ–æ©‹ãƒ»å¤©ç‹å¯ºãƒ»é˜¿å€é‡ãƒ»é•·å±…ã€ã‚¨ãƒªã‚¢ã‹ã‚‰æŠ½å‡ºã—ã¦ã„ã¾ã™ã€‚<br>
      ãƒ»è¡¨ç¤ºã•ã‚Œã‚‹ã€Œå¹³å‡ä¾¡æ ¼ã€ã¯ã€æ¥½å¤©ãƒˆãƒ©ãƒ™ãƒ«æ¤œç´¢ä¸Šä½æ–½è¨­ã®å¹³å‡æœ€ä½ä¾¡æ ¼ã§ã™ã€‚<br>
      ãƒ»ç©ºå®¤æ•°ã® <span style="color:blue;">ï¼ˆ+Nï¼‰</span> / <span style="color:red;">ï¼ˆâˆ’Nï¼‰</span> ã¯ã€å‰å›å·¡å›æ™‚ç‚¹ã¨ã®åœ¨åº«æ•°ã®å¢—æ¸›ã§ã™ã€‚<br>
      ãƒ»å¹³å‡ä¾¡æ ¼ã® <span style="color:red;">â†‘</span> / <span style="color:blue;">â†“</span> ã¯ã€å‰å›å·¡å›æ™‚ç‚¹ã¨ã®å¹³å‡ä¾¡æ ¼ã®ä¸Šæ˜‡/ä¸‹é™ã§ã™ã€‚<br>
      ãƒ»ä¼šå ´ã‚¢ã‚¤ã‚³ãƒ³ï¼š<span style="color:#e53939;">ğŸ”´</span>äº¬ã‚»ãƒ©ãƒ‰ãƒ¼ãƒ  / <span style="color:#357ebd;">ğŸ”µ</span>ãƒ¤ãƒ³ãƒãƒ¼ã‚¹ã‚¿ã‚¸ã‚¢ãƒ  / <span style="color:#888;">â˜…</span>ãã®ä»–ä¼šå ´<br>
      ãƒ»ç‚ãƒãƒ¼ã‚¯ï¼ˆéœ€è¦ã‚·ãƒ³ãƒœãƒ«ï¼‰ã®å†…è¨³ï¼š<br>
      ã€€ã€€<span style="color:#ffa600;">ğŸ”¥1</span>ï¼šæ®‹å®¤ â‰¤250 ã¾ãŸã¯ ä¾¡æ ¼ â‰¥25,000å††<br>
      ã€€ã€€<span style="color:#be0c0c;">ğŸ”¥2</span>ï¼šæ®‹å®¤ â‰¤200 ã¾ãŸã¯ ä¾¡æ ¼ â‰¥30,000å††<br>
      ã€€ã€€<span style="color:#e94e77;">ğŸ”¥3</span>ï¼šæ®‹å®¤ â‰¤150 ã¾ãŸã¯ ä¾¡æ ¼ â‰¥35,000å††<br>
      ã€€ã€€<span style="color:#ff6600;">ğŸ”¥4</span>ï¼šæ®‹å®¤ â‰¤100 ã¾ãŸã¯ ä¾¡æ ¼ â‰¥40,000å††<br>
      ã€€ã€€<span style="color:#421c16;">ğŸ”¥5</span>ï¼šæ®‹å®¤ â‰¤70 ã¾ãŸã¯ ä¾¡æ ¼ â‰¥50,000å††<br>
    </div>
  </footer>

  <!-- testå°‚ç”¨JSï¼šãƒˆã‚°ãƒ«çŠ¶æ…‹ä¿å­˜ï¼‹â€œæ¶ˆãˆãŸã‚‰å³å¾©æ´»â€ãƒ­ã‚¸ãƒƒã‚¯ -->
  <script>
    (function(){
      const KEY="compareMode";
      const get=()=>localStorage.getItem(KEY)==="1";
      const update=(on)=>{
        const b=document.getElementById("compareToggle"), s=document.getElementById("toggleState");
        if(b&&s){ b.setAttribute("aria-pressed", on?"true":"false"); s.textContent= on?"ON":"OFF"; }
      };
      const set=(on)=>{ localStorage.setItem(KEY,on?"1":"0"); update(on); };

      // ãƒˆã‚°ãƒ«DOMã‚’ #calendar-container å†…ã«ç¢ºå®Ÿã«é…ç½®
      function ensureToggle(){
        const container=document.getElementById("calendar-container");
        if(!container) return;
        let holder=document.getElementById("compareToggleHolder");
        if(!holder || !container.contains(holder)){
          holder=document.createElement("div");
          holder.id="compareToggleHolder";
          holder.className="compare-toggle-fixed";
          holder.innerHTML=`<button id="compareToggle" class="compare-toggle" aria-pressed="false" aria-label="è‡ªç¤¾æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ã‚’åˆ‡æ›¿">
            <span class="dot" aria-hidden="true"></span><span>è‡ªç¤¾æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰</span><span id="toggleState">OFF</span></button>`;
          container.prepend(holder);
          document.getElementById("compareToggle").addEventListener("click", ()=>set(!get()));
        }
        update(get());
      }

      // åˆæœŸåŒ–
      document.addEventListener("DOMContentLoaded", ()=>{
        ensureToggle();
        // 1) ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå…¨ä½“ã‚’ç›£è¦–ï¼ˆã‚³ãƒ³ãƒ†ãƒŠä¸¸ã”ã¨å·®ã—æ›¿ãˆå¯¾ç­–ï¼‰
        const obs = new MutationObserver(() => ensureToggle());
        obs.observe(document.body, { childList:true, subtree:true });
        // 2) ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼šåˆæœŸ5ç§’ã¯500msãŠãã«ç¢ºèª
        let n=0; const t=setInterval(()=>{ ensureToggle(); if(++n>10) clearInterval(t); }, 500);
        // 3) ãƒªã‚µã‚¤ã‚ºæ™‚ã‚‚ä¸€å¿œæ›´æ–°
        window.addEventListener("resize", ensureToggle);
      });
    })();
  </script>

  <!-- æœ€å¾Œã«app.jsï¼ˆæœ¬ç•ªã¨åŒã˜ï¼‰ -->
  <script src="app.js"></script>
</body>
</html>
